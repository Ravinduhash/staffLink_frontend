<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewpoint" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="vehicleform.css">

        <title>Vehicle Registration</title>
    </head>


    <body>
        <div class="container">
            <div class="title">Vehicle Registration</div>
            <form action="#">
                <div class="intro">
                    <div class="vehicle-details">
                        <div class="input-box">
                            <span class="details">Owner Email</span>
                            <input type="text" class="ownerEmail" placeholder="Enter your owner email" required>
                            <div id="ownerEmail-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">Vehicle Number</span>
                            <input type="text" class="vehicleNumber" placeholder="Enter your vehicle number" required>
                            <div id="vehicleNo-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">Vehicle Type</span>
                            <select class="vehicle-type" id="vehicle-type">
                                <option class="default" value>Select the vehicle type</option>
                                <option value="Van">Van</option>
                                <option value="Bus">Bus</option>
                                <option value="Car">Car</option>
                            </select>
                            <div id="type-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">Vehicle Brand</span>
                            <input type="text" class="vehicleBrand" placeholder="Enter your vehicle brand" required>
                            <div id="brand-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">Vehicle Model</span>
                            <input type="text" class="vehicleModel" placeholder="Enter your vehicle model" required>
                            <div id="model-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">Registration Number</span>
                            <input type="text" class="vehicleRegNo" placeholder="Enter your vehicle reg no" required>
                            <div id="vehicleRegNo-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">Driver Email</span>
                            <input type="text" class="driverEmail" placeholder="Enter the driver email" required>
                            <div id="driverEmail-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">Number of Seats</span>
                            <input type="text" class="seatCount" placeholder="Enter the total no of seats" required>
                            <div id="seatCount-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">Starting Location</span>
                            <input type="text" class="startingLocation" placeholder="Select the starting location">
                            <div id="startingLocation-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">End Location</span>
                            <input type="text" class="endLocation" placeholder="Select the end location">
                            <div id="endLocation-error-message" style="display: none; color: red;"></div>
                        </div>
                        <div class="input-box">
                            <span class="details">Vehicle Trips</span>
                            <select class="vehicle-trips" id="vehicle-trips">
                                <option class="default" value>Select the relevent type</option>
                                <option value="Morning">Morning</option>
                                <option value="Evening">Evening</option>
                                <option value="Both">Both</option>
                            </select>
                            <div id="vehicleTrips-error-message" style="display: none; color: red;"></div>
                        </div>
                        <!-- <div class="input-box">
                            <span class="details">Photo of the Vehicle</span>
                            <input class="photo" type="file" placeholder="Select the photo" accept="image/*">
                        </div> -->
                        <div class="button">
                        </div>
                        
                    </div>
                    <button onclick="btn1()">Next</button>
                </div>
                <div class="image" style="display: none;">
                    <div class="container">
                        <div class="photo-set" style="display: flex;">
                            <div style="width: 50%;">
                                <div class="sub-title" id="st2">Front View of Vehicle</div>
                                <div class="profilepic">
                                  <div class="card">
                                    <img src="./file.png" id="front-view-pic">
                                  </div>
                                </div>
                                <label class="btn" for="front-view-file">Add Photo</label>
                                <input type="file" accept="image/*" id="front-view-file" style="display: none;">
                              </div>

                              <div style="width: 50%;">
                                <div class="sub-title" id="st2">Side View of Vehicle</div>
                                <div class="profilepic">
                                  <div class="card">
                                    <img src="./file.png" id="side-view-pic">
                                  </div>
                                </div>
                                <label class="btn" for="side-view-file">Add Photo</label>
                                <input type="file" accept="image/*" id="side-view-file" style="display: none;">
                              </div>
                        </div>

                        <div class="photo-set" style="display: flex;">
                            <div style="width: 50%;">
                                <div class="sub-title" id="st2">Rear View of Vehicle</div>
                                <div class="profilepic">
                                  <div class="card">
                                    <img src="./file.png" id="rear-view-pic">
                                  </div>
                                </div>
                                <label class="btn" for="rear-view-file">Add Photo</label>
                                <input type="file" accept="image/*" id="rear-view-file" style="display: none;">
                              </div>

                              <div style="width: 50%;">
                                <div class="sub-title" id="st2">Inside View of Vehicle</div>
                                <div class="profilepic">
                                  <div class="card">
                                    <img src="./file.png" id="inside-view-pic">
                                  </div>
                                </div>
                                <label class="btn" for="inside-view-file">Add Photo</label>
                                <input type="file" accept="image/*" id="inside-view-file" style="display: none;">
                              </div>
                        </div>
                        <!-- <div class="photo-set" style="display: flex;">
                            <div>
                                <div class="sub-title" id="st2">Rear View of Vehicle</div>
                                <div class="profilepic">
                                    <div class="card">
                                        <img src="https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_1280.png" id="default-pic">
                                    </div>
                                </div>
                                <label for="pic">Update Photo</label>
                                <input type="file" accept="image/.*" id="pic">
                                <button class="pic-del btn" onclick="deletePhoto()">Delete Photo</button>
                            </div>
                            <div>
                                <div class="sub-title" id="st2">Inside View of Vehicle</div>
                                <div class="profilepic">
                                    <div class="card">
                                        <img src="https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_1280.png" id="default-pic">
                                    </div>
                                </div>
                                <label for="pic">Update Photo</label>
                                <input type="file" accept="image/.*" id="pic">
                                <button class="pic-del btn" onclick="deletePhoto()">Delete Photo</button>
                            </div> -->
                        <!-- </div> -->



                        <!-- <div class="input-box">
                            <span class="details">Front View of Vehicle</span>
                            <input class="photo" type="file" placeholder="Select the photo" accept="image/*">
                        </div>
                        <div class="input-box">
                            <span class="details">Back View of Vehicle</span>
                            <input class="photo" type="file" placeholder="Select the photo" accept="image/*">
                        </div>
                        <div class="input-box">
                            <span class="details">Left View of Vehicle</span>
                            <input class="photo" type="file" placeholder="Select the photo" accept="image/*">
                        </div>
                        <div class="input-box">
                            <span class="details">Right View of Vehicle</span>
                            <input class="photo" type="file" placeholder="Select the photo" accept="image/*">
                        </div>
                        <div class="input-box">
                            <span class="details">Inside View of Vehicle</span>
                            <input class="photo" type="file" placeholder="Select the photo" accept="image/*">
                        </div> -->
                    </div>
                    <button onclick="prev1()">Previous</button>
                    <button onclick="img()">Next</button>
                </div>
            </form>
            <!-- <input type="submit" class="sub" value="Register" onclick=""> -->
        </div>
        <!-- <script src="vehicleForm.js"></script> -->
        <script>
            function btn1(){
                document.querySelector(".intro").style.display = "none";
                document.querySelector(".image").style.display = "block";
            }
            function prev1(){
                document.querySelector(".intro").style.display = "block";
                document.querySelector(".image").style.display = "none";
            }

            let frontPic = document.getElementById("front-view-pic");
            let frontFile = document.getElementById("front-view-file");

            frontFile.onchange = function(){
                frontPic.src = URL.createObjectURL(frontFile.files[0]);
            }

            let sidePic = document.getElementById("side-view-pic");
            let sideFile = document.getElementById("side-view-file");

            sideFile.onchange = function(){
                sidePic.src = URL.createObjectURL(sideFile.files[0]);
            }

            let rearPic = document.getElementById("rear-view-pic");
            let rearFile = document.getElementById("rear-view-file");

            rearFile.onchange = function(){
                rearPic.src = URL.createObjectURL(rearFile.files[0]);
            }

            let insidePic = document.getElementById("inside-view-pic");
            let insideFile = document.getElementById("inside-view-file");
            
            insideFile.onchange = function(){
                insidePic.src = URL.createObjectURL(insideFile.files[0]);
            }

            function img() {
                let ownerEmail = document.querySelector(".ownerEmail").value;
                let vehicleNumber = document.querySelector(".vehicleNumber").value;
                let vehicleType = document.querySelector(".vehicle-type").value;
                let vehicleBrand = document.querySelector(".vehicleBrand").value;
                let vehicleModel = document.querySelector(".vehicleModel").value;
                let vehicleRegNo = document.querySelector(".vehicleRegNo").value;
                let driverEmail = document.querySelector(".driverEmail").value;
                let seatCount = document.querySelector(".seatCount").value;
                let startingLocation = document.querySelector(".startingLocation").value;
                let endLocation = document.querySelector(".endLocation").value;
                let vehicleTrips = document.querySelector(".vehicle-trips").value;

                let fileInput = document.getElementById("front-view-file");
                let fileInput2 = document.getElementById("side-view-file");
                let fileInput3 = document.getElementById("rear-view-file");
                let fileInput4 = document.getElementById("inside-view-file");

                let data = {"email":"rhatu2000@gmail.com"};
            
                if (fileInput.files.length > 0) {
                    let formData = new FormData();
                    formData.append("image", fileInput.files[0]);
                    formData.append("email", "rhatu2000@gmail.com");
                    formData.append("vehicleNumber", vehicleNumber);
                    formData.append("vehicleType", vehicleType);
                    formData.append("vehicleBrand", vehicleBrand);
                    formData.append("vehicleModel", vehicleModel);
                    formData.append("vehicleRegNo", vehicleRegNo);
                    formData.append("driverEmail", driverEmail);
                    formData.append("seatCount", seatCount);
                    formData.append("startingLocation", startingLocation);
                    formData.append("endLocation", endLocation);
                    formData.append("vehicleTrips", vehicleTrips);
                    //formData.append("extension", getImageFileExtension(fileInput));

                

                    alert(getImageFileExtension(fileInput));
            
                    fetch('http://localhost:8080/try2_war_exploded/imageUpload', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log(data.message);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
                } else {
                    console.error('No file selected');
                }
            }
            
            function getImageFileExtension(fileInput) {
                // Check if a file is selected
                if (fileInput.files.length > 0) {
                    // Get the selected file
                    let file = fileInput.files[0];
            
                    // Split the file name at the last dot to get the file extension
                    let fileNameParts = file.name.split(".");
                    if (fileNameParts.length > 1) {
                        // Return the file extension (convert to lowercase for consistency)
                        return fileNameParts[fileNameParts.length - 1].toLowerCase();
                    }
                }
            
                // Return null if no file or no extension found
                return null;
            }
            
            
            
        </script>
    </body>
</html>